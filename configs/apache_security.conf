# --- Apache Security Hardening Configuration ---
# File: /etc/apache2/conf-available/apache_security.conf

# 1. Hide Server Information (Obfuscation)
# Do not send the server version or OS information in response headers.
ServerTokens Prod
ServerSignature Off

# 2. Clickjacking/XSS Protection (Use Header Module)
# Enables HTTP Strict Transport Security (HSTS) - forces HTTPS connection
<IfModule mod_headers.c>
    # Prevents Clickjacking by disallowing framing
    Header always append X-Frame-Options "SAMEORIGIN"
    # Enables basic Cross-Site Scripting (XSS) protection in browsers
    Header set X-XSS-Protection "1; mode=block"
    # Controls what information is sent in the Referer header
    Header set Referrer-Policy "no-referrer-when-downgrade"
    # Controls what resources the page is allowed to load
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none';"
    
    # HSTS - Must only be used if HTTPS is fully functional!
    # Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
</IfModule>

# 3. Directory Browsing Protection
# Prevent users from listing the contents of directories without an index file.
<Directory />
    Options -Indexes
</Directory>

# 4. Limit Resource Consumption (DOS Protection)
# Limits the size of HTTP request bodies to prevent memory-based DOS attacks
LimitRequestBody 1048576 # 1 MB limit

# 5. Disable TRACE Method (Prevents Cross-Site Tracing)
TraceEnable Off
